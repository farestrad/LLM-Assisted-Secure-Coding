import axios from 'axios';

export class VulnerabilityDatabaseProvider {
    private static API_BASE_URL = 'https://cveawg.mitre.org/api/cve';

    public async fetchCveDetails(cveId: string): Promise<any> {
        try {
            const response = await axios.get(`${VulnerabilityDatabaseProvider.API_BASE_URL}/${cveId}`);
            return response.data;
        } catch (error) {
            // Narrow the type of `error` to properly handle it
            if (axios.isAxiosError(error)) {
                // Handle Axios-specific error
                console.error(`Axios error: ${error.message}`);
                throw new Error(`Unable to fetch CVE details: ${error.message}`);
            } else if (error instanceof Error) {
                // Handle generic JavaScript Error
                console.error(`Generic error: ${error.message}`);
                throw new Error(`Unable to fetch CVE details: ${error.message}`);
            } else {
                // Handle unexpected error types
                console.error(`Unexpected error: ${JSON.stringify(error)}`);
                throw new Error(`An unexpected error occurred while fetching CVE details.`);
            }
        }
    }
}
